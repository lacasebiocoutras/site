define(["jquery","moment"],function(e,a){e.fn.loadFermetures=function(n){var t,d=e.ajax({dataType:"json",type:"GET",url:n,success:function(e){t=e},error:function(){console.log("fermeture.json non disponible")}}),r=d.then(function(){var n=[0,1],d=["DDMMMMY","DoMMMMY"];return e.each(t,function(t,r){a.locale("fr");var i,o,s=!0,f=a(r.dateDebut,d),l=a(r.dateFin,d),u=a(r.dateDebut,d).add("-"+r.delaiAlerte,"days"),m=!0;if(l.isValid())if(f.isValid()){var M;M=a.min(f,l),l=a.max(f,l),f=M,f.isSame(l)||(s=!1)}else f=l;if(s){if(i=a(u).subtract(1,"days"),o=a(f).add(1,"days"),a().isBetween(i.format(),o.format())){var c,p=a(f).day(),v=n.length;for(c=0;c<v;c++)p===n[c]&&(m=!1);if(m===!0)return e("#aside-fermeture").closest("div").removeClass("invisible"),e("<li>").html("<h4>"+r.title+"</h4>").appendTo("#aside-fermeture").fadeIn(),e("<li>").html(a(f).format("dddd Do MMMM")).appendTo("#aside-fermeture").fadeIn(),!1}}else{var h="serons";if(m=!1,i=a(f).subtract(1,"days"),o=a(l).add(1,"days"),a().isBetween(i.format(),o.format())?(m=!0,h="sommes"):(i=a(u).subtract(1,"days"),o=a(f).add(1,"days"),a().isBetween(i.format(),o.format())&&(m=!0)),m===!0)return e("#aside-fermeture").closest("div").removeClass("invisible"),e("<li>").html("<h4>"+r.title+"</h4>").appendTo("#aside-fermeture").fadeIn(),e("<li>").html("Nous&nbsp;"+h+"&nbsp;ferm√©s du").appendTo("#aside-fermeture").fadeIn(),e("<li>").html(a(f).format("dddd Do MMMM")+"&nbsp;au").appendTo("#aside-fermeture").fadeIn(),e("<li>").html(a(l).format("dddd Do MMMM")).appendTo("#aside-fermeture").fadeIn(),!1}})});r.done(function(){})},e.fn.loadEvenements=function(n){var t,d=e.ajax({dataType:"json",type:"GET",url:n,success:function(e){t=e},error:function(){console.log("evenement.json non disponible")}}),r=d.then(function(){return e.each(t,function(n,t){var d=a(t.dateExpire,["DDMMMMY","MMMMDDY"]).format(),r=a(t.dateExpire,["DDMMMMY","MMMMDDY"]).add(-7,"days").format();return!!a().isBetween(r,d)&&(e("<li>").html(t.title).appendTo("#aside-events").fadeIn(),!1)})});r.done(function(){})}});